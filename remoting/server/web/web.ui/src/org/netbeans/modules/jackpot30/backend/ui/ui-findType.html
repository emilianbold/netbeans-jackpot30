<html>
<head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/base/jquery-ui.css" rel="stylesheet" type="text/css">
    <script type="text/javascript">
        function methodPopup(relativePath, resultFile, signature) {
            $('#popup').html('<a href="/index/ui/show?path=' + relativePath + '&relative=' + resultFile + '">Source Code</a><br>' +
                             '<a href="/index/ui/usages?path=' + relativePath + '&signatures=' + signature + '">Usages in the defining project</a><br>' +
                             '<a href="/index/ui/usages?signatures=' + signature + '">Usages in all known projects</a><br>' +
                             '<a href="/index/ui/implements?path=' + relativePath + '&method=' + signature + '">Overriders in the defining project</a><br>' +
                             '<a href="/index/ui/implements?method=' + signature + '">Overriders in all known projects</a><br>')
                            .dialog({
                                title: 'Show',
                                width: 460 //XXX: hardcoded size
                            });
        }
        function classPopup(relativePath, resultFile, signature) {
            $('#popup').html('<a href="/index/ui/show?path=' + relativePath + '&relative=' + resultFile + '">Source Code</a><br>' +
                             '<a href="/index/ui/usages?path=' + relativePath + '&signatures=' + signature + '">Usages in the defining project</a><br>' +
                             '<a href="/index/ui/usages?signatures=' + signature + '">Usages in all known projects</a><br>' +
                             '<a href="/index/ui/implements?path=' + relativePath + '&type=' + signature + '">Subtypes in the defining project</a><br>' +
                             '<a href="/index/ui/implements?type=' + signature + '">Subtypes in all known projects</a><br>')
                            .dialog({
                                title: 'Show',
                                width: 400 //XXX: hardcoded size
                            });
        }
        function otherPopup(relativePath, resultFile, signature) {
            $('#popup').html('<a href="/index/ui/show?path=' + relativePath + '&relative=' + resultFile + '">Source Code</a><br>' +
                             '<a href="/index/ui/usages?path=' + relativePath + '&signatures=' + signature + '">Usages in the defining project</a><br>' +
                             '<a href="/index/ui/usages?signatures=' + signature + '">Usages in all known projects</a><br>')
                            .dialog({
                                title: 'Show'
                            });
        }
        function checkAllProjectsCheckBox() {
            allChecked = $('.projectCheckBox').filter(function(index) {
                return !this.checked;
            }).length == 0;
            if (!allChecked) $('#allProjectsCheckBox')[0].checked = false;
        }
        function checkCheckBoxes() {
            if (!$('#allProjectsCheckBox')[0].checked) return;
            allChecked = $('.projectCheckBox').each(function(index) {
                this.checked = true;
            }).length == 0;
        }
        $(document).ready(function() {
            checkAllProjectsCheckBox();
        })
    </script>
</head>
<body>
<form method="get">
<label for="prefix">Search for:</label><input type="text" name="prefix"<#if prefix??>value="${prefix}"</#if>/><br>
<label>Projects:</label>
<table><tr>
        <td>    <input id="allProjectsCheckBox" type="checkbox" onclick="checkCheckBoxes();" checked="yes">All</input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<#list paths as path>
<td><input class="projectCheckBox" type="checkbox" name="path" onclick="checkAllProjectsCheckBox();" value="${path.segment}" <#if !selectedPath?? || selectedPath?seq_contains(path.segment)> checked="yes"</#if>>${path.displayName}</input>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<#if path_index % 5 == 3></tr><tr></#if>
</#list>
    </tr></table>
<br>
<input type="submit" name="Find Candidates"/>
</form>

<#if results??>
    Found symbols:<br>
    <table>
        <#list results as result>
        <tr>
            <td>
                <nobr>
                <img src="/index/icons/${result.icon}" alt="${result.kind}"/>
                <#if result.kind == "METHOD">
                    <a href="javascript: methodPopup('${result.segment.segment}', '${result.file}', '${result.kind}:${result.enclosingFQN}:${result.simpleName}:${result.signature}')">
                <#elseif result.kind == "CLASS" || result.kind == "INTERFACE" || result.kind == "ENUM" || result.kind == "ANNOTATION_TYPE">
                    <a href="javascript: classPopup('${result.segment.segment}', '${result.file}', '${result.kind}:${result.fqn}')">
                <#else>
                    <a href="javascript: otherPopup('${result.segment.segment}', '${result.file}', '${result.kind}:${result.enclosingFQN}:${result.simpleName}')">
                </#if>
                ${result.displayName?replace("&", "&amp;")?replace("<", "&lt;")}</a> in ${result.enclosingFQN?replace("&", "&amp;")?replace("<", "&lt;")}
                </nobr>
            </td>
            <td width="100%" align="right">${result.segment.displayName?replace("&", "&amp;")?replace("<", "&lt;")}</td>
        </tr>
        </#list>
</#if>

<div id="popup"></div>
</body>
</html>
